package kr.co.jsp.user.service;

import java.io.PrintWriter;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import kr.co.jsp.user.model.UserDAO;
import kr.co.jsp.user.model.UserVO;

public class JoinService implements IUserService {

	@Override
	public void execute(HttpServletRequest request, HttpServletResponse response) {

		response.setContentType("text/html; charset=UTF-8");
		
		String id = request.getParameter("id");
		UserDAO dao = UserDAO.getInstance();
		
		String htmlCode;
		
		PrintWriter out = response.getWriter();
		
		if(dao.confirmId(id)) {
			htmlCode = "<script>\r\n" +
							"alert(\"아이디가 중복되었습니다.\");\r\n" +
							"history.back();\r\n" +
					   "</script>" ;
					out.print(out);
		
		} else {
		UserVO vo = new UserVO(
					id,
					request.getParameter("pw"),
					request.getParameter("name"),
					request.getParameter("email"),
					request.getParameter("address")
				);
		dao.insertUser(vo);
		
		UserDAO.getInstance().insertUser(vo);
	}

}
